/**
 * This file is part of the NocoBase (R) project.
 * Copyright (c) 2020-2024 NocoBase Co., Ltd.
 * Authors: NocoBase Team.
 *
 * This project is dual-licensed under AGPL-3.0 and NocoBase Commercial License.
 * For more information, please refer to: https://www.nocobase.com/agreement.
 */

(function(e,n){typeof exports=="object"&&typeof module!="undefined"?n(exports,require("@nocobase/client"),require("@nocobase/plugin-auth/client"),require("react/jsx-runtime"),require("react"),require("antd")):typeof define=="function"&&define.amd?define(["exports","@nocobase/client","@nocobase/plugin-auth/client","react/jsx-runtime","react","antd"],n):(e=typeof globalThis!="undefined"?globalThis:e||self,n(e["@mybricks/weixin-api"]={},e["@nocobase/client"],e["@nocobase/plugin-auth"],e.jsxRuntime,e.react,e.antd))})(this,function(e,n,s,i,c,t){"use strict";var h=(e,n,s)=>new Promise((i,c)=>{var t=r=>{try{u(s.next(r))}catch(a){c(a)}},m=r=>{try{u(s.throw(r))}catch(a){c(a)}},u=r=>r.done?i(r.value):Promise.resolve(r.value).then(t,m);u((s=s.apply(e,n)).next())});const m="@mybricks/weixin-api",u="weixin",r="weixinConfiguration",a=()=>{const l=n.useAPIClient(),[p]=t.Form.useForm();c.useEffect(()=>{l.resource(r).get({}).then(o=>{var d;p.setFieldsValue(((d=o.data)==null?void 0:d.data)||{})}).catch(o=>{console.log(o),t.message.error("获取配置失败")})},[l,p]);const y=c.useCallback(o=>{console.log("values",o),l.resource(r).set(o).then(d=>{t.message.success("保存成功")}).catch(d=>{t.message.error("保存失败")})},[l]);return i.jsx(t.Card,{title:"微信小程序开发者ID设置",bordered:!1,children:i.jsxs(t.Form,{form:p,layout:"vertical",onFinish:y,children:[i.jsx(t.Form.Item,{required:!0,name:"appid",label:"AppID(小程序ID)",children:i.jsx(t.Input,{})}),i.jsx(t.Form.Item,{required:!0,name:"secret",label:"AppSecret(小程序密钥)",children:i.jsx(t.Input,{})}),i.jsx(t.Form.Item,{children:i.jsx(t.Button,{type:"primary",htmlType:"submit",children:"保存"})})]})})};class f extends n.Plugin{afterAdd(){return h(this,null,function*(){})}beforeLoad(){return h(this,null,function*(){})}load(){return h(this,null,function*(){this.app.pluginSettingsManager.add(m,{title:"微信接口配置",icon:"WechatOutlined",Component:a}),this.app.pm.get(s).registerType(u)})}}e.WeixinApiClient=f,e.default=f,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
